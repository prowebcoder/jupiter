{%- assign sid = '#shopify-section-' | append: section.id -%}

{%- style -%}
  {{ sid }} .pc-newsletter {
    background-color: {{ section.settings.background_color }};
    color: {{ section.settings.text_color }};
    padding: {{ section.settings.padding_top }}px {{ section.settings.padding_right }}px {{ section.settings.padding_bottom }}px {{ section.settings.padding_left }}px;
    position: relative;
    overflow: hidden;
  }

  {{ sid }} .pc-newsletter__wrapper {
    max-width: {{ section.settings.content_width }}px;
    margin: 0 auto;
    display: flex;
    flex-direction: {{ section.settings.layout_direction }};
    align-items: center;
    gap: {{ section.settings.gap_between }}px;
    position: relative;
    z-index: 2;
  }

  {{ sid }} .pc-newsletter__content {
    flex: 1;
    padding: 2rem;
  }

  {{ sid }} .pc-newsletter__image-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    border-radius: {{ section.settings.image_border_radius }}px;
    {% if section.settings.enable_parallax %}
      min-height: 400px;
    {% endif %}
  }

  {{ sid }} .pc-newsletter__image {
    width: 100%;
    height: auto;
    display: block;
    transition: transform 0.3s ease;
    {% if section.settings.enable_parallax %}
      position: absolute;
      height: 100%;
      object-fit: cover;
      will-change: transform;
    {% endif %}
  }

  {{ sid }} .pc-newsletter__image:hover {
    transform: scale(1.03);
  }

  /* Newsletter Layout Styles */
  {{ sid }} .pc-newsletter__content--layout-1 {
    background: transparent;
  }

  {{ sid }} .pc-newsletter__content--layout-2 {
    background: {{ section.settings.content_background | default: '#ffffff' }};
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    padding: 3rem;
  }

  {{ sid }} .pc-newsletter__content--layout-3 {
    background: linear-gradient(135deg, {{ section.settings.gradient_color_1 | default: '#f3f4f6' }}, {{ section.settings.gradient_color_2 | default: '#e5e7eb' }});
    border-radius: 12px;
    padding: 3rem;
    border: 1px solid rgba(0,0,0,0.05);
  }

  {{ sid }} .pc-newsletter__content--layout-4 {
    background: {{ section.settings.content_background | default: '#ffffff' }};
    border-radius: 0;
    padding: 3rem;
    border-left: 5px solid {{ section.settings.accent_color | default: '#000000' }};
  }

  {{ sid }} .pc-newsletter__heading {
    font-size: {{ section.settings.heading_size }}px;
    margin-bottom: 1.5rem;
    line-height: 1.2;
    color: {{ section.settings.heading_color }};
  }

  {{ sid }} .pc-newsletter__subheading {
    font-size: {{ section.settings.subheading_size }}px;
    margin-bottom: 2rem;
    opacity: 0.9;
    color: {{ section.settings.subheading_color }};
  }

  {{ sid }} .pc-newsletter-form {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    max-width: 500px;
  }

  {{ sid }} .pc-newsletter-form__field-wrapper {
    flex: 1;
    min-width: 200px;
  }

  {{ sid }} .pc-newsletter-form__field {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid {{ section.settings.input_border_color }};
    border-radius: {{ section.settings.input_border_radius }}px;
    background-color: {{ section.settings.input_background_color }};
    color: {{ section.settings.input_text_color }} !important;
    font-size: {{section.settings.input_font_size}} !important;
    transition: all 0.3s ease;
  }

  {{ sid }} .pc-newsletter-form__field:focus {
    border-color: {{ section.settings.input_focus_border_color }};
    outline: none;
    box-shadow: 0 0 0 2px {{ section.settings.input_focus_shadow_color | default: 'rgba(0,0,0,0.05)' }};
  }

  {{ sid }} .pc-newsletter-form__button {
    padding: 12px 30px;
    background-color: {{ section.settings.button_background_color }};
    color: {{ section.settings.button_text_color }};
    border: none;
    border-radius: {{ section.settings.button_border_radius }}px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 16px;
  }

  {{ sid }} .pc-newsletter-form__button:hover {
    background-color: {{ section.settings.button_hover_background_color }};
    transform: translateY(-2px);
  }

  {{ sid }} .pc-newsletter__decoration {
    position: absolute;
    z-index: 1;
  }

  {{ sid }} .pc-newsletter__decoration--1 {
    top: -50px;
    left: -50px;
    width: 100px;
    height: 100px;
    background: {{ section.settings.decoration_color_1 | default: 'rgba(0,0,0,0.03)' }};
    border-radius: 50%;
  }

  {{ sid }} .pc-newsletter__decoration--2 {
    bottom: -30px;
    right: -30px;
    width: 60px;
    height: 60px;
    background: {{ section.settings.decoration_color_2 | default: 'rgba(0,0,0,0.03)' }};
    border-radius: 50%;
  }

  @media screen and (max-width: 768px) {
    {{ sid }} .pc-newsletter__wrapper {
      flex-direction: column;
    }

    {{ sid }} .pc-newsletter__content,
    {{ sid }} .pc-newsletter__image-container {
      width: 100%;
    }

    {{ sid }} .pc-newsletter {
      padding: {{ section.settings.mobile_padding_top }}px {{ section.settings.mobile_padding_right }}px {{ section.settings.mobile_padding_bottom }}px {{ section.settings.mobile_padding_left }}px;
    }

    {{ sid }} .pc-newsletter__content--layout-2,
    {{ sid }} .pc-newsletter__content--layout-3,
    {{ sid }} .pc-newsletter__content--layout-4 {
      padding: 2rem;
    }

    {{ sid }} .pc-newsletter__image-container {
      min-height: 300px;
    }
  }
{%- endstyle -%}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    {% if section.settings.enable_parallax %}
      const parallaxElements = document.querySelectorAll('{{ sid }} .pc-newsletter__image');

      window.addEventListener('scroll', function() {
        const scrollPosition = window.pageYOffset;

        parallaxElements.forEach(function(element) {
          const elementOffset = element.parentElement.offsetTop;
          const distance = scrollPosition - elementOffset;
          element.style.transform = 'translateY(' + distance * {{ section.settings.parallax_speed | default: 0.1 }} + 'px)';
        });
      });
    {% endif %}
  });
</script>

<div class="pc-newsletter">
  <div class="pc-newsletter__decoration pc-newsletter__decoration--1"></div>
  <div class="pc-newsletter__decoration pc-newsletter__decoration--2"></div>

  <div class="pc-newsletter__wrapper">
    <div class="pc-newsletter__content pc-newsletter__content--layout-{{ section.settings.newsletter_layout }}">
      {%- if section.settings.heading != blank -%}
        <h2 class="pc-newsletter__heading "
          style="font-weight: {{section.settings.font_weight}};
          padding-top: {{ section.settings.padding_top_first }};
          padding-bottom: {{ section.settings.padding_bottom_first }};
          font-style: {{ section.settings.font_style }};
          text-decoration: {{ section.settings.text_decoration }}
          "
          >{{ section.settings.heading }}</h2>
      {%- endif -%}

      {%- if section.settings.subheading != blank -%}
        <div class="pc-newsletter__subheading"
           style="font-weight: {{section.settings.font_weight_second}};
          padding-top: {{ section.settings.padding_top_second }};
          padding-bottom: {{ section.settings.padding_bottom_second }};
          font-style: {{ section.settings.font_style_second }};
          text-decoration: {{ section.settings.text_decoration_second }}
          "
          >{{ section.settings.subheading }}</div>
      {%- endif -%}

      {%- form 'customer', class: 'pc-newsletter-form' -%}
        <input type="hidden" name="contact[tags]" value="newsletter">
        <div class="pc-newsletter-form__field-wrapper">
          <input
            id="NewsletterForm--{{ section.id }}"
            type="email"
            name="contact[email]"
            class="pc-newsletter-form__field"
            value="{{ form.email }}"
            aria-required="true"
            autocorrect="off"
            autocapitalize="off"
            autocomplete="email"
            {% if form.errors %}
              autofocus
              aria-invalid="true"
              aria-describedby="Newsletter-error--{{ section.id }}"
            {% elsif form.posted_successfully? %}
              aria-describedby="Newsletter-success--{{ section.id }}"
            {% endif %}
            placeholder="{{ section.settings.email_placeholder }}"
            required
          >
        </div>
        <button type="submit" class="pc-newsletter-form__button" name="commit">
          {{ section.settings.button_label }}
        </button>
        {%- if form.errors -%}
          <small class="pc-newsletter-form__message form__message" id="Newsletter-error--{{ section.id }}">
            {%- render 'icon-error' -%}
            {{ form.errors.translated_fields.email | capitalize }}
            {{ form.errors.messages.email -}}
          </small>
        {%- endif -%}
      {%- endform -%}

      {%- if form.posted_successfully? -%}
        <h3
          class="pc-newsletter-form__message pc-newsletter-form__message--success form__message"
          id="Newsletter-success--{{ section.id }}"
          tabindex="-1"
          autofocus
        >
          {% render 'icon-success' -%}
          {{- 'newsletter.success' | t }}
        </h3>
      {%- endif -%}
    </div>

    <div class="pc-newsletter__image-container">
      {%- if section.settings.image != blank -%}
        <img
          srcset="
            {%- if section.settings.image.width >= 375 -%}{{ section.settings.image | image_url: width: 375 }} 375w,{%- endif -%}
            {%- if section.settings.image.width >= 550 -%}{{ section.settings.image | image_url: width: 550 }} 550w,{%- endif -%}
            {%- if section.settings.image.width >= 750 -%}{{ section.settings.image | image_url: width: 750 }} 750w,{%- endif -%}
            {%- if section.settings.image.width >= 1100 -%}{{ section.settings.image | image_url: width: 1100 }} 1100w,{%- endif -%}
            {%- if section.settings.image.width >= 1500 -%}{{ section.settings.image | image_url: width: 1500 }} 1500w,{%- endif -%}
            {%- if section.settings.image.width >= 1780 -%}{{ section.settings.image | image_url: width: 1780 }} 1780w,{%- endif -%}
            {%- if section.settings.image.width >= 2000 -%}{{ section.settings.image | image_url: width: 2000 }} 2000w,{%- endif -%}
            {%- if section.settings.image.width >= 3000 -%}{{ section.settings.image | image_url: width: 3000 }} 3000w,{%- endif -%}
            {{ section.settings.image | image_url }} {{ section.settings.image.width }}w
          "
          src="{{ section.settings.image | image_url: width: 750 }}"
          sizes="(min-width: 750px) 50vw, 100vw"
          loading="lazy"
          class="pc-newsletter__image"
          alt="{{ section.settings.image.alt | escape }}"
          width="{{ section.settings.image.width }}"
          height="{{ section.settings.image.width | divided_by: section.settings.image.aspect_ratio }}"
        >
      {%- else -%}
        {{ 'image' | placeholder_svg_tag: 'pc-newsletter__image placeholder-svg' }}
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "PC Newsletter with Image",
  "tag": "section",
  "class": "shopify-section--pc-newsletter-with-image",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
     {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#f8f8f8"
    },
    {
      "type": "select",
      "id": "layout_direction",
      "label": "Layout direction",
      "options": [
        {
          "value": "row",
          "label": "Newsletter left / Image right"
        },
        {
          "value": "row-reverse",
          "label": "Image left / Newsletter right"
        }
      ],
      "default": "row"
    },
    {
      "type": "select",
      "id": "newsletter_layout",
      "label": "Newsletter design layout",
      "options": [
        {
          "value": "1",
          "label": "Layout 1 - Simple"
        },
        {
          "value": "2",
          "label": "Layout 2 - Card"
        },
        {
          "value": "3",
          "label": "Layout 3 - Gradient"
        },
        {
          "value": "4",
          "label": "Layout 4 - Accent Border"
        }
      ],
      "default": "1"
    },
    {
      "type": "range",
      "id": "content_width",
      "min": 800,
      "max": 2500,
      "step": 50,
      "unit": "px",
      "label": "Section max width",
      "default": 2000
    },
    {
      "type": "range",
      "id": "gap_between",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Gap between content and image",
      "default": 50
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "default": "Subscribe to our newsletter",
      "label": "Heading"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 20,
      "max": 60,
      "step": 1,
      "unit": "px",
      "label": "Heading font size",
      "default": 36
    },
     {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#333333"
    },
     {
          "type": "select",
          "id": "font_weight",
          "label": "Font weight",
          "options": [
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "bold",
              "label": "Bold"
            },
            {
              "value": "bolder",
              "label": "Bolder"
            },
            {
              "value": "lighter",
              "label": "Lighter"
            },
            {
              "value": "100",
              "label": "100"
            },
            {
              "value": "200",
              "label": "200"
            },
            {
              "value": "300",
              "label": "300"
            },
            {
              "value": "400",
              "label": "400"
            },
            {
              "value": "500",
              "label": "500"
            },
            {
              "value": "600",
              "label": "600"
            },
            {
              "value": "700",
              "label": "700"
            },
            {
              "value": "800",
              "label": "800"
            },
            {
              "value": "900",
              "label": "900"
            }
          ],
          "default": "normal"
        },
        {
          "type": "select",
          "id": "font_style",
          "label": "Font style",
          "options": [
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "italic",
              "label": "Italic"
            },
            {
              "value": "oblique",
              "label": "Oblique"
            }
          ],
          "default": "normal"
        },
     {
          "type": "select",
          "id": "text_decoration",
          "label": "Text Decoration",
          "options": [
            {
              "value": "none",
              "label": "None"
            },
            {
              "value": "underline",
              "label": "Underline"
            },
            {
              "value": "overline",
              "label": "Overline"
            },
            {
              "value": "line-through",
              "label": "Line Through"
            }
          ],
          "default": "none"
        },
        {
      "type": "range",
      "id": "padding_top_first",
      "label": "Padding Top (px)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5
    },
    {
      "type": "range",
      "id": "padding_bottom_first",
      "label": "Padding Bottom (px)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5
    },
    {
      "type": "richtext",
      "id": "subheading",
      "default": "<p>Be the first to know about new products, special offers, and more.</p>",
      "label": "Subheading"
    },
    {
      "type": "range",
      "id": "subheading_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Subheading font size",
      "default": 18
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading color",
      "default": "#555555"
    },
     {
          "type": "select",
          "id": "font_weight_second",
          "label": "Font weight",
          "options": [
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "bold",
              "label": "Bold"
            },
            {
              "value": "bolder",
              "label": "Bolder"
            },
            {
              "value": "lighter",
              "label": "Lighter"
            },
            {
              "value": "100",
              "label": "100"
            },
            {
              "value": "200",
              "label": "200"
            },
            {
              "value": "300",
              "label": "300"
            },
            {
              "value": "400",
              "label": "400"
            },
            {
              "value": "500",
              "label": "500"
            },
            {
              "value": "600",
              "label": "600"
            },
            {
              "value": "700",
              "label": "700"
            },
            {
              "value": "800",
              "label": "800"
            },
            {
              "value": "900",
              "label": "900"
            }
          ],
          "default": "normal"
        },
        {
          "type": "select",
          "id": "font_style_second",
          "label": "Font style",
          "options": [
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "italic",
              "label": "Italic"
            },
            {
              "value": "oblique",
              "label": "Oblique"
            }
          ],
          "default": "normal"
        },
     {
          "type": "select",
          "id": "text_decoration_second",
          "label": "Text Decoration",
          "options": [
            {
              "value": "none",
              "label": "None"
            },
            {
              "value": "underline",
              "label": "Underline"
            },
            {
              "value": "overline",
              "label": "Overline"
            },
            {
              "value": "line-through",
              "label": "Line Through"
            }
          ],
          "default": "none"
        },
        {
      "type": "range",
      "id": "padding_top_second",
      "label": "Padding Top (px)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5
    },
    {
      "type": "range",
      "id": "padding_bottom_second",
      "label": "Padding Bottom (px)",
      "default": 5,
      "min": 0,
      "max": 150,
      "step": 5
    },
    {
      "type": "text",
      "id": "email_placeholder",
      "default": "Your email address",
      "label": "Email placeholder text"
    },
       {
      "type": "range",
      "id": "input_font_size",
      "label": "Input Font Size (px)",
      "default": 16,
      "min": 12,
      "max": 24,
      "step": 1
    },
     {
      "type": "color",
      "id": "input_text_color",
      "label": "Input Text Color"
    },
     {
      "type": "color",
      "id": "input_background_color",
      "label": "Input background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Input border color",
      "default": "#dddddd"
    },
    {
      "type": "range",
      "id": "input_border_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Input border radius",
      "default": 4
    },
    {
      "type": "color",
      "id": "input_focus_border_color",
      "label": "Input focus border color",
      "default": "#999999"
    },
    {
      "type": "color",
      "id": "input_focus_shadow_color",
      "label": "Input focus shadow color",
      "default": "rgba(0,0,0,0.05)"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "Subscribe",
      "label": "Button label"
    },
      {
      "type": "color",
      "id": "button_background_color",
      "label": "Button background color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
     {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 4
    },
    {
      "type": "color",
      "id": "button_hover_background_color",
      "label": "Button hover background",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Image"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "label": "Image border radius",
      "default": 12
    },
    {
      "type": "checkbox",
      "id": "enable_parallax",
      "label": "Enable parallax effect",
      "default": false
    },
    {
      "type": "range",
      "id": "parallax_speed",
      "min": 1,
      "max": 10,
      "step": 1,
      "label": "Parallax speed",
      "default": 2,
      "info": "Lower values create slower parallax effects"
    },
    {
      "type": "header",
      "content": "Layout Design Options"
    },
    {
      "type": "color",
      "id": "content_background",
      "label": "Content background (Layout 2 & 4)",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color (Layout 4)",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "gradient_color_1",
      "label": "Gradient color 1 (Layout 3)",
      "default": "#f3f4f6"
    },
    {
      "type": "color",
      "id": "gradient_color_2",
      "label": "Gradient color 2 (Layout 3)",
      "default": "#e5e7eb"
    },
    {
      "type": "color",
      "id": "decoration_color_1",
      "label": "Decoration color 1",
      "default": "rgba(0,0,0,0.03)"
    },
    {
      "type": "color",
      "id": "decoration_color_2",
      "label": "Decoration color 2",
      "default": "rgba(0,0,0,0.03)"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Padding top",
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Padding bottom",
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_left",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Padding left",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_right",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Padding right",
      "default": 20
    },
    {
      "type": "header",
      "content": "Mobile spacing"
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Mobile padding top",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Mobile padding bottom",
      "default": 30
    },
    {
      "type": "range",
      "id": "mobile_padding_left",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Mobile padding left",
      "default": 15
    },
    {
      "type": "range",
      "id": "mobile_padding_right",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Mobile padding right",
      "default": 15
    }
  ],
  "presets": [
    {
      "name": "PC Newsletter with Image",
      "category": "Promotional"
    }
  ]
}
{% endschema %}
