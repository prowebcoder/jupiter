{% assign sec_id = '#shopify-section-' | append: section.id %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<style>
{{ sec_id }} .pw-discover-by-category {
  padding: 40px 20px;
  background: #fff;
}

{{ sec_id }} .pw-category-heading {
  text-align: center;
  font-size: 2.2rem;
  font-weight: bold;
  margin-bottom: 30px;
}

{{ sec_id }} .swiper {
  overflow: visible;
}

{{ sec_id }} .swiper-slide {
  background-size: cover;
  background-position: center;
  border-radius: 16px;
  color: white;
  position: relative;
  display: flex;
  align-items: flex-end;
  text-decoration: none;
  overflow: hidden;
  height: 340px;
  transition: transform 0.3s ease;
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15);
}

{{ sec_id }} .swiper-slide:hover {
  transform: scale(1.05);
}

{{ sec_id }} .pw-card-content {
  background: linear-gradient(to top, rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.05));
  padding: 16px;
  width: 100%;
}

{{ sec_id }} .pw-card-title {
  font-weight: bold;
  margin-bottom: 6px;
}

{{ sec_id }} .pw-card-rating {
  font-size: 0.95rem;
  margin-bottom: 6px;
}

{{ sec_id }} .pw-card-subtext {
  margin-bottom: 10px;
  line-height: 1.4;
}

{{ sec_id }} .pw-shop-now-button {
  padding: 7px 16px;
  font-weight: 600;
  border: none;
  cursor: pointer;
  font-size: 14px;
}

/* Button shape classes */
{{ sec_id }} .pw-shop-now-button.pill {
  border-radius: 9999px;
}

{{ sec_id }} .pw-shop-now-button.rounded {
  border-radius: 12px;
}

{{ sec_id }} .pw-shop-now-button.square {
  border-radius: 0;
}

/* Responsive sizes */
@media (max-width: 767px) {
  {{ sec_id }} .swiper-slide {
    height: 280px;
  }

  {{ sec_id }} .pw-card-title {
    font-size: 16px !important;
  }

  {{ sec_id }} .pw-card-subtext {
    font-size: 13px !important;
  }

  {{ sec_id }} .pw-card-rating {
    font-size: 13px;
  }

  {{ sec_id }} .pw-shop-now-button {
    padding: 5px 12px;
    font-size: 13px;
  }
}
</style>

<div class="pw-discover-by-category">
  {% if section.settings.heading != blank %}
    <h2 class="pw-category-heading">{{ section.settings.heading }}</h2>
  {% endif %}

  <div class="swiper pw-category-swiper">
    <div class="swiper-wrapper">
      {% for block in section.blocks %}
        {% assign collection = collections[block.settings.collection] %}
        <a href="{{ collection.url }}" class="swiper-slide" style="background-image: url({{ block.settings.image | img_url: '800x' }});">
          <div class="pw-card-content">
            <h3 class="pw-card-title" style="color: {{ block.settings.title_color }}; font-size: {{ block.settings.title_size }}px;">
              {{ collection.title | upcase }}
            </h3>
            <div class="pw-card-rating">★ ★ ★ ★ ☆</div>
            <p class="pw-card-subtext" style="color: {{ block.settings.subtitle_color }}; font-size: {{ block.settings.subtitle_size }}px;">
              {{ block.settings.subtitle }}
            </p>
            <button class="pw-shop-now-button {{ block.settings.button_shape }}" style="background-color: {{ block.settings.button_background_color }}; color: {{ block.settings.button_text_color }};">
              Shop now
            </button>
          </div>
        </a>
      {% endfor %}
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    new Swiper(".pw-category-swiper", {
      slidesPerView: window.innerWidth < 768
        ? {{ section.settings.mobile_card_count | default: 2 }}
        : 3,
      spaceBetween: 16,
      loop: true,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      breakpoints: {
        768: {
          slidesPerView: 3
        },
        1024: {
          slidesPerView: 4
        }
      }
    });
  });
</script>

{% schema %}
{
  "name": "Collection Grid pwc",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Main Heading",
      "default": "Discover by Category"
    },
    {
      "type": "select",
      "id": "mobile_card_count",
      "label": "Mobile Cards per Slide",
      "options": [
        {
          "value": "1",
          "label": "1 card"
        },
        {
          "value": "2",
          "label": "2 cards"
        }
      ],
      "default": "2"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category Card",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Select Collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Background Image"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle",
          "default": "Show off your style and stay hydrated wherever you go."
        },
        {
          "type": "color",
          "id": "title_color",
          "label": "Title Color",
          "default": "#ffffff"
        },
        {
          "type": "range",
          "id": "title_size",
          "label": "Title Font Size (px)",
          "min": 12,
          "max": 36,
          "default": 18
        },
        {
          "type": "color",
          "id": "subtitle_color",
          "label": "Subtitle Color",
          "default": "#ffffff"
        },
        {
          "type": "range",
          "id": "subtitle_size",
          "label": "Subtitle Font Size (px)",
          "min": 10,
          "max": 24,
          "default": 14
        },
        {
          "type": "select",
          "id": "button_shape",
          "label": "Button Shape",
          "options": [
            {
              "value": "pill",
              "label": "Pill"
            },
            {
              "value": "rounded",
              "label": "Rounded"
            },
            {
              "value": "square",
              "label": "Square"
            }
          ],
          "default": "rounded"
        },
        {
          "type": "color",
          "id": "button_background_color",
          "label": "Button Background Color",
          "default": "#ffffff"
        },
        {
          "type": "color",
          "id": "button_text_color",
          "label": "Button Text Color",
          "default": "#000000"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Collection Grid pwc",
      "category": "Collections"
    }
  ]
}
{% endschema %}
